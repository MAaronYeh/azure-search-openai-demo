import{r as n,bD as ue,bE as e}from"./vendor-d92a9189.js";import{A as a,R as i,u as S,S as de,Q as he,E as me,a as Se,b as g,c as ge,d as xe,T as Ce,g as ve,e as Te}from"./index-58a27442.js";import{n as fe,k as ye,D as Re,o as Ae,T as x,l as _e,C,m as be}from"./fluentui-react-33c3fe38.js";import"./fluentui-icons-e61b4934.js";const ke="_oneshotContainer_p6613_1",je="_oneshotTopSection_p6613_8",Pe="_oneshotBottomSection_p6613_15",Ne="_oneshotTitle_p6613_25",we="_oneshotQuestionInput_p6613_39",Be="_oneshotAnswerContainer_p6613_46",Ee="_oneshotAnalysisPanel_p6613_53",Ue="_oneshotSettingsSeparator_p6613_58",De="_settingsButton_p6613_62",o={oneshotContainer:ke,oneshotTopSection:je,oneshotBottomSection:Pe,oneshotTitle:Ne,oneshotQuestionInput:we,oneshotAnswerContainer:Be,oneshotAnalysisPanel:Ee,oneshotSettingsSeparator:Ue,settingsButton:De};function Fe(){const[j,v]=n.useState(!1),[r,H]=n.useState(a.RetrieveThenRead),[T,I]=n.useState(""),[f,V]=n.useState(""),[y,Q]=n.useState(""),[c,G]=n.useState(i.Hybrid),[P,L]=n.useState(3),[R,M]=n.useState(!0),[N,q]=n.useState(!1),[w,K]=n.useState(""),[B,z]=n.useState(!1),[E,J]=n.useState(!1),A=n.useRef(""),[_,U]=n.useState(!1),[p,D]=n.useState(),[u,W]=n.useState(),[F,O]=n.useState(),[d,l]=n.useState(void 0),h=S?ue().instance:void 0,b=async t=>{A.current=t,p&&D(void 0),U(!0),O(void 0),l(void 0);const s=h?await ve(h):void 0;try{const m={question:t,approach:r,overrides:{promptTemplate:T.length===0?void 0:T,promptTemplatePrefix:f.length===0?void 0:f,promptTemplateSuffix:y.length===0?void 0:y,excludeCategory:w.length===0?void 0:w,top:P,retrievalMode:c,semanticRanker:R,semanticCaptions:N,useOidSecurityFilter:B,useGroupsSecurityFilter:E},idToken:s?.accessToken},pe=await Te(m);W(pe)}catch(m){D(m)}finally{U(!1)}},X=(t,s)=>{I(s||"")},Y=(t,s)=>{V(s||"")},Z=(t,s)=>{Q(s||"")},$=(t,s)=>{L(parseInt(s||"3"))},ee=(t,s,m)=>{G(s?.data||i.Hybrid)},te=(t,s)=>{H(s?.key||a.RetrieveThenRead)},se=(t,s)=>{M(!!s)},oe=(t,s)=>{q(!!s)},ne=(t,s)=>{K(s||"")},ae=t=>{b(t)},ie=t=>{F===t&&d===g.CitationTab?l(void 0):(O(t),l(g.CitationTab))},k=t=>{l(d===t?void 0:t)},re=(t,s)=>{z(!!s)},le=(t,s)=>{J(!!s)},ce=[{key:a.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:a.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:a.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return e.jsxs("div",{className:o.oneshotContainer,children:[e.jsxs("div",{className:o.oneshotTopSection,children:[e.jsx(de,{className:o.settingsButton,onClick:()=>v(!j)}),e.jsx("h1",{className:o.oneshotTitle,children:"Ask your data"}),e.jsx("div",{className:o.oneshotQuestionInput,children:e.jsx(he,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:_,onSend:t=>b(t)})})]}),e.jsxs("div",{className:o.oneshotBottomSection,children:[_&&e.jsx(fe,{label:"Generating answer"}),!A.current&&e.jsx(me,{onExampleClicked:ae}),!_&&u&&!p&&e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(Se,{answer:u,isStreaming:!1,onCitationClicked:t=>ie(t),onThoughtProcessClicked:()=>k(g.ThoughtProcessTab),onSupportingContentClicked:()=>k(g.SupportingContentTab)})}),p?e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(ge,{error:p.toString(),onRetry:()=>b(A.current)})}):null,d&&u&&e.jsx(xe,{className:o.oneshotAnalysisPanel,activeCitation:F,onActiveTabChanged:t=>k(t),citationHeight:"600px",answer:u,activeTab:d})]}),e.jsxs(ye,{headerText:"Configure answer generation",isOpen:j,isBlocking:!1,onDismiss:()=>v(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(Re,{onClick:()=>v(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(Ae,{className:o.oneshotSettingsSeparator,label:"Approach",options:ce,defaultSelectedKey:r,onChange:te}),(r===a.RetrieveThenRead||r===a.ReadDecomposeAsk)&&e.jsx(x,{className:o.oneshotSettingsSeparator,defaultValue:T,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:X}),r===a.ReadRetrieveRead&&e.jsxs(e.Fragment,{children:[e.jsx(x,{className:o.oneshotSettingsSeparator,defaultValue:f,label:"Override prompt prefix template",multiline:!0,autoAdjustHeight:!0,onChange:Y}),e.jsx(x,{className:o.oneshotSettingsSeparator,defaultValue:y,label:"Override prompt suffix template",multiline:!0,autoAdjustHeight:!0,onChange:Z})]}),e.jsx(_e,{className:o.oneshotSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:P.toString(),onChange:$}),e.jsx(x,{className:o.oneshotSettingsSeparator,label:"Exclude category",onChange:ne}),e.jsx(C,{className:o.oneshotSettingsSeparator,checked:R,label:"Use semantic ranker for retrieval",onChange:se}),e.jsx(C,{className:o.oneshotSettingsSeparator,checked:N,label:"Use query-contextual summaries instead of whole documents",onChange:oe,disabled:!R}),S&&e.jsx(C,{className:o.oneshotSettingsSeparator,checked:B,label:"Use oid security filter",disabled:!h?.getActiveAccount(),onChange:re}),S&&e.jsx(C,{className:o.oneshotSettingsSeparator,checked:E,label:"Use groups security filter",disabled:!h?.getActiveAccount(),onChange:le}),e.jsx(be,{className:o.oneshotSettingsSeparator,label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:c==i.Hybrid,data:i.Hybrid},{key:"vectors",text:"Vectors",selected:c==i.Vectors,data:i.Vectors},{key:"text",text:"Text",selected:c==i.Text,data:i.Text}],required:!0,onChange:ee}),S&&e.jsx(Ce,{})]})]})}Fe.displayName="OneShot";export{Fe as Component};
//# sourceMappingURL=OneShot-0cac35fa.js.map
